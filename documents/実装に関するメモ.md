# 実装で役に立ちそうなメモ

## model
### distilbert-base-uncased
- 元モデル: bert-base-uncased
- bertを蒸留して小型化したモデル（40%削減）
- 大文字小文字を区別しない
- 書籍と Wikipedia で事前学習さ
- 高速。軽量、低コスト
- 用途：テキスト分類、感情分析、名前付きエンティティ認識 (NER)、クエリ応答システム (QA)、テキスト埋め込みの生成
- 


- 
- 
- 
- 
- 
- 
- 
- 
- 


## クラス
### AutoModelForSequenceClassification
- テキスト分類タスク向けのモデルアーキテクチャクラス
- 文章をカテゴリーに分類するのに特化
- from_pretrained関数で引数を設定
- model_name：モデル名を指定
- num_labels：分類するクラス数
- ターゲットデータ次第（正解データ）でカテゴリ分類してくれる
- 

### TrainingArguments
- トレーニングの各種設定するクラス
- 引数めっちゃ多い
■引数
- output_dir：モデル保存ディレクトリ　モデル名を入れれば自動的に取得してくれるっぽい
- num_train_epochs：エポック数
- learning_rate：学習率　デフォルト5e-5
- per_device_train_batch_size：
- per_device_eval_batch_size：
- weight_decay：重み減衰
- evaluation_strategy：
- disable_tqdm：
- logging_steps：
- push_to_hub：
- log_level：
- 
### Trainerクラス
- モデルのトレーニング、評価、予測を行う
- 評価指標の計算、ログ出力、モデルの保存などを簡単に実装可能
■引数
- model：トレーニング対象のモデル
- args：トレーニングの設定を含むオブジェクト
- compute_metrics：評価指標を計算する関数を指定
- train_dataset：トレーニングデータセット
- eval_dataset：検証データセットを指定
- tokenizer：トークナイザを指定
■関連関数
- .train()：トレーニング
- .evaluate()：評価
- .predict(test_dataset)：予測
■compute_metrics
- 実装に関してはお作法がある
- 正解ラベル：pred.label_ids
- 予測ラベルの計算結果：pred.predictions.argmax(-1)
- f1スコア：f1_score(labels, preds, average="weighted")　#加重平均
- 精度計算：accuracy_score(labels, predictions)
- 平均絶対誤差： mean_absolute_error(labels, preds)
- 
- 
- 
- 
- 




## 関数
### train_test_split
■引数
- 対象のデータ：トレーニング/テストしたいデータセットを入れる
- target：ターゲット（正解カラム）のいれる　例 train["Rating"]
- test_size(=0.25)：テストデータの割合　デフォルト25%
- train_size(=0.75)：トレーニングデータの割合　デフォルト75%
- shuffle(=False)：データ全体をシャッフルするか否か
- random_state：整数値を入れると再現性のあるデータシャッフルが可能
- 
■戻り値
- X_train: 80%のトレーニングデータ　　①
- X_test: 残り20%のトレーニングデータ　②
- y_train: 80%のtargetデータ　③
- y_test: 残り20%のtargetデータ　④
- Xが全カラム変数、yが答え
- trainが80%のデータ、testが20%のデータ

■メモ
- sklearnにある関数
- 訓練データとテストデータを作成してくれる
- ホールドアウト法なので指定した割合でデータを分割してくれる
- 引数：test_size、train_sizeは両方数値を調整できるが、合計1を超えるとエラーになる
- 変数名ではなく順番が大事　
- 
- 
- 


## datasets.Features
■引数
- 辞書型　カラム名, 型
- 例  
{  
    "text": Value("string"),  # テキストデータ  
    "age": Value("int64"),    # 整数データ  
    "rating": Value("float32")  # 浮動小数点数データ  
}  
- Valueは「string」「int64」「float32」「bool」が定義できる
- ClassLabelはラベルを扱う（名義尺度、順序尺度）enumのように数字とラベルを対にできる
- ClassLabel：ClassLabel-クラス数の指定
- ClassLabel：names-クラス名のリスト
- ClassLabel：names_file-クラス名を格納したファイル
■戻り値
- 
- 
- 
- 
- 
- 
- 

■メモ
- データセットの各列を定義する
- 各列の名前と型を定義
- 
- 
- 
- 
- 


### map
■引数
- 実行したい関数
- batched：true-バッチ単位処理　false-1行単位処理
- batch_size：バッチサイズ（1000）

■戻り値
- 引数で渡した関数次第で変化
- 例えばカラムを指定して、そのカラムのデータを変更できるし、そのカラムを基に新たなカラムも作成可能
- 
- 
- 
- 
- 

■メモ
- Hugging Face Datasets ライブラリの一種
- データセット内の各行またはバッチに対して、指定された関数を適用し、変換された結果を返す
- 
- 
- 
- 
- 


### train_test_split
■引数
- 
- 
- 
- 
- 
- 
- 
■戻り値
- 
- 
- 
- 
- 
- 
- 

■メモ
- 
- 
- 
- 
- 
- 
- 